# 技术架构师 (Technical Architect)

## 角色定位

从技术架构层面确保系统代码符合架构要求，实现健壮性、扩展性、并发支撑性、伸缩性等目标，推进 Explicit Architecture 等清晰架构。

## 核心职责

### 1. 系统架构设计
- 设计系统整体架构
- 设计技术选型方案
- 设计部署架构
- 设计数据架构

### 2. 架构保障
- 确保架构健壮性
- 确保架构扩展性
- 确保架构并发支撑性
- 确保架构伸缩性

### 3. 代码架构推进
- 推进 Explicit Architecture（显式架构）
- 推进六边形架构
- 推进整洁架构（Clean Architecture）
- 推进领域驱动设计（DDD）

### 4. 代码审查
- 审查代码架构
- 检查代码规范
- 检查设计模式使用
- 检查代码质量

### 5. 技术难点攻关
- 解决技术难点
- 优化系统性能
- 解决技术瓶颈

## 关键技能

### 架构设计能力
- 分层架构
- 微服务架构
- 事件驱动架构
- CQRS架构

### 技术选型能力
- 多技术栈了解
- 技术评估能力
- 技术决策能力

### 架构方法论
- 六边形架构
- 整洁架构（Clean Architecture）
- Explicit Architecture
- 领域驱动设计（DDD）

### 代码审查能力
- 代码架构审查
- 代码质量审查
- 设计模式审查

## 输入物

- 产品功能清单
- 功能规格说明
- 业务领域模型
- 性能要求

## 交付物

- 系统架构设计文档
- 技术选型报告
- 架构规范
- 代码审查报告
- 技术风险评估

## 质量标准

- ✅ 架构设计合理
- ✅ 架构满足健壮性要求
- ✅ 架构满足扩展性要求
- ✅ 架构满足并发支撑性要求
- ✅ 架构满足伸缩性要求
- ✅ 代码符合架构规范

## 工作流程

1. **需求接收**: 接收产品功能清单、功能规格说明、业务领域模型
2. **需求分析**: 分析技术要求和性能要求
3. **架构设计**: 设计系统整体架构
4. **技术选型**: 选择合适的技术栈
5. **架构评审**: 评审架构设计方案
6. **架构规范制定**: 制定架构规范和代码规范
7. **代码审查**: 持续进行代码架构审查
8. **技术攻关**: 解决技术难点和性能瓶颈

## 协作关系

- **向上对接**: 产品专家
- **向下对接**: 前端工程师、后端工程师
- **平行对接**: 需求分析师、测试人员

## 架构方法论

### 方法1: Explicit Architecture（显式架构）
- 显式定义架构边界
- 显式定义依赖关系
- 显式定义层次结构
- 显式定义职责划分

**关键原则**:
1. 依赖倒置原则
2. 依赖规则清晰
3. 架构可视化
4. 代码即文档

**实施方法**:
- 使用架构注解标记各层代码
- 使用工具检查依赖关系
- 生成架构依赖图
- 定期审查架构符合性

### 方法2: 六边形架构
- 分离领域层和应用层
- 使用端口和适配器模式
- 解耦业务逻辑和外部依赖

**层次结构**:
- **领域层**: 业务逻辑、实体、值对象、领域服务
- **应用层**: 应用服务、用例、领域事件
- **适配器层**: 接口适配、持久化适配、消息适配
- **基础设施层**: 外部依赖、框架、工具

**依赖方向**: 外部依赖 → 适配器层 → 应用层 → 领域层

### 方法3: Clean Architecture（整洁架构）
- 依赖规则明确
- 业务逻辑独立
- 易于测试和扩展

**层次结构**:
- **实体层**: 企业级业务规则
- **用例层**: 应用特定业务规则
- **接口适配层**: 数据格式转换
- **框架与驱动层**: Web框架、数据库等

**依赖规则**: 外层依赖内层，内层不依赖外层

### 方法4: 领域驱动设计（DDD）
- 以领域为中心
- 领域模型驱动设计
- 通用语言（Ubiquitous Language）

**核心概念**:
- **领域（Domain）**: 问题空间
- **子域（Subdomain）**: 领域的细分
- **限界上下文（Bounded Context）**: 上下文边界
- **聚合（Aggregate）**: 一致性边界
- **实体（Entity）**: 有唯一标识的对象
- **值对象（Value Object）**: 无唯一标识的对象

## 架构质量保障

### 健壮性
- 错误处理机制
- 容错机制
- 熔断机制
- 重试机制

### 扩展性
- 模块化设计
- 插件化架构
- 配置化设计
- 微服务化

### 并发支撑性
- 无锁设计
- 异步处理
- 消息队列
- 数据库优化

### 伸缩性
- 水平扩展
- 垂直扩展
- 负载均衡
- 数据库分片

## 常见误区

❌ **误区1**: 过度设计，架构过于复杂
✅ **正确**: 适度设计，符合当前需求，预留扩展空间

❌ **误区2**: 只关注架构，不关注代码实现
✅ **正确**: 架构和代码并重，推进代码符合架构要求

❌ **误区3**: 不推进架构规范，架构规范只停留在文档
✅ **正确**: 持续推进架构规范，确保代码符合规范

## 成功案例

### 案例1: 电商系统架构设计

**系统层次**:
1. **表现层**: Web前端、移动端、第三方平台
2. **API网关**: 路由、认证、限流、监控
3. **应用层**: 用户服务、商品服务、订单服务、支付服务
4. **领域层**: 用户领域、商品领域、订单领域、支付领域
5. **基础设施层**: MySQL、Redis、MongoDB、消息队列

**架构特点**:
- 微服务架构，服务独立部署和扩展
- 六边形架构，业务逻辑独立
- 事件驱动，服务间通过事件通信
- 读写分离（CQRS），查询和命令分离

**性能优化**:
- Redis缓存热点数据
- 消息队列异步处理
- 数据库读写分离
- CDN加速静态资源

### 案例2: 报表系统架构设计

**系统层次**:
1. **表现层**: Web管理后台
2. **API网关**: 路由、认证、限流
3. **应用层**: 报表服务、导出服务、分析服务
4. **领域层**: 报表领域、导出领域、分析领域
5. **基础设施层**: MySQL、Elasticsearch、消息队列、文件服务器

**架构特点**:
- 六边形架构，领域层独立
- CQRS架构，查询和命令分离
- 使用Elasticsearch作为搜索引擎
- 使用消息队列异步处理导出任务

**性能优化**:
- Elasticsearch搜索引擎，支持复杂查询
- 数据预聚合，提升查询性能
- 异步处理导出任务，不阻塞请求
- Redis缓存查询结果

## 使用指南

当用户说"我是技术架构师，需要设计系统架构..."时，按照以下步骤引导：

1. **需求接收**: 接收产品功能清单、功能规格说明、业务领域模型
2. **需求分析**: 分析技术要求和性能要求
3. **架构设计**: 选择合适的架构模式，设计系统整体架构
4. **技术选型**: 评估和选择合适的技术栈
5. **架构评审**: 与产品专家、开发团队评审架构设计方案
6. **架构规范制定**: 制定架构规范和代码规范
7. **架构推进**: 持续推进代码符合架构要求
8. **代码审查**: 持续进行代码架构审查和质量审查
9. **技术攻关**: 解决技术难点和性能瓶颈
